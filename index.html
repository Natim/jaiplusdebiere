<!DOCTYPE HTML>
<!--
	Overflow by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>J'ai plus de bière</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="stylesheet" href="assets/css/styles.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
         <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
               integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
               crossorigin=""/>
         <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
                 integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
                 crossorigin=""></script>

				 <!-- Load Esri Leaflet from CDN -->
		     <script src="https://unpkg.com/esri-leaflet@2.2.3/dist/esri-leaflet.js"
		     integrity="sha512-YZ6b5bXRVwipfqul5krehD9qlbJzc6KOGXYsDjU9HHXW2gK57xmWl2gU6nAegiErAqFXhygKIsWPKbjLPXVb2g=="
		     crossorigin=""></script>


		   <!-- Load Esri Leaflet Geocoder from CDN -->
		   <link rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder@2.2.13/dist/esri-leaflet-geocoder.css"
		     integrity="sha512-v5YmWLm8KqAAmg5808pETiccEohtt8rPVMGQ1jA6jqkWVydV5Cuz3nJ9fQ7ittSxvuqsvI9RSGfVoKPaAJZ/AQ=="
		     crossorigin="">
		   <script src="https://unpkg.com/esri-leaflet-geocoder@2.2.13/dist/esri-leaflet-geocoder.js"
		     integrity="sha512-zdT4Pc2tIrc6uoYly2Wp8jh6EPEWaveqqD3sT0lf5yei19BC1WulGuh5CesB0ldBKZieKGD7Qyf/G0jdSe016A=="
		     crossorigin=""></script>

	</head>
	<body class="is-preload">

		<!-- Header -->
			<section id="header">
				<header>
					<h1>J'ai plus de bière</h1>
					<p>Pas d'inquiètude ! Nous en avons !</p>
				</header>
				<footer>
					<a href="#banner" class="button style2 scrolly-middle">Ah ouais ? Deal !</a>
				</footer>
			</section>

		<!-- Banner -->
			<section id="banner">
				<header>
					<h2>Oui, mais pas n'importe quelle bière !</h2>
				</header>
				<p><strong>Locale</strong> : Notre bière est fabriquée par des artisants brasseurs autour de Rennes.</p>
                <p><strong>Biologique</strong> : Elle se déguste tout en préservant notre environnement .</p>
                <p><strong>Artisanale</strong> : Parce qu'avoir soif ne justifie pas tout.</p>
				<footer>
					<a href="#first" class="button style2 scrolly">Ça suffit, j'ai soif !</a>
				</footer>
			</section>

		<!-- Feature 1 -->
			<article id="first" class="container box style1 right">
				 <div id="map" class="image fit"></div>
				<div class="inner">
					<header>
						<h2>On vous livre où ?</h2>
					</header>
					<form method="post" action="#">
						<div class="row">
							<div class="col-12 col-12-mobile">
								<input class="text" type="text" name="address" id="address" placeholder="Votre adresse" autocomplete="off" />
							</div>
						</div>
						<div><p id="answer"></p></div>
					</form>
				</div>
			</article>

		<!-- Portfolio -->
			<article class="container box style2">
				<header>
					<h2>Bon, du coup qu'est-ce qu'on vous amène ?</h2>
				</header>
				<div class="inner gallery">
					<div class="row gtr-0">
						<div class="col-3 col-12-mobile"><a href="images/fulls/01.jpg" class="image fit"><img src="images/thumbs/01.jpg" alt="" title="Ad infinitum" /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/02.jpg" class="image fit"><img src="images/thumbs/02.jpg" alt="" title="Dressed in Clarity" /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/03.jpg" class="image fit"><img src="images/thumbs/03.jpg" alt="" title="Raven" /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/04.jpg" class="image fit"><img src="images/thumbs/04.jpg" alt="" title="I'll have a cup of Disneyland, please" /></a></div>
					</div>
					<div class="row gtr-0">
						<div class="col-3 col-12-mobile"><a href="images/fulls/05.jpg" class="image fit"><img src="images/thumbs/05.jpg" alt="" title="Cherish" /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/06.jpg" class="image fit"><img src="images/thumbs/06.jpg" alt="" title="Different." /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/07.jpg" class="image fit"><img src="images/thumbs/07.jpg" alt="" title="History was made here" /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/08.jpg" class="image fit"><img src="images/thumbs/08.jpg" alt="" title="People come and go and walk away" /></a></div>
					</div>
				</div>
			</article>

		<!-- Contact -->
			<article class="container box style3">
				<header>
					<h2>On y est presque…</h2>
				</header>
				<form method="post" action="#">
					<div class="row gtr-50">
						<div class="col-6 col-12-mobile"><input type="text" class="text" name="name" placeholder="Nom" /></div>
						<div class="col-6 col-12-mobile"><input type="text" class="text" name="phone" placeholder="Téléphone" /></div>
						<div class="col-12">
							<ul class="actions">
								<li><input type="submit" value="C'est parti !" /></li>
							</ul>
						</div>
					</div>
				</form>
			</article>


		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/jquery.poptrox.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

      <script>
			var map = L.map('map').setView([48.0833, -1.6833], 13);
			L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
				maxZoom: 18,
				attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
					'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
					'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
				id: 'mapbox.streets'
			}).addTo(map);

			var results = L.layerGroup().addTo(map);

			addressForm = document.getElementById('address');
			let radius = 5500;
			let cityCenter = L.latLng(48.109905, -1.679177);
			let boundaries = L.circle(cityCenter, radius, {opacity: 0.4});

			let database = {};

			address.oninput = function(e) {
				if (e.target.value.length > 10) {
					fetch(buildUrl("https://api-adresse.data.gouv.fr/search/", {
						q: e.target.value,
						lat: cityCenter.lat,
						lon: cityCenter.lng
					}))
					.then(response => response.json())
					.then(data => {
						if (data.features.length > 0) {
							results.clearLayers();
							let geolocation = data.features[0];
							let coordinates = geolocation.geometry.coordinates;
							let latlng = L.latLng(coordinates[1], coordinates[0]);
							results.addLayer(L.marker(latlng));
							map.setView(latlng, 13);

							let distance = latlng.distanceTo(cityCenter);
							var bounds = L.latLngBounds([cityCenter, latlng]);
							map.fitBounds(bounds);
							if (distance >= radius) {
								boundaries.addTo(map);
								document.getElementById('answer').innerHTML = "Un peu loin pour nous… Désolé !";
							} else {
								boundaries.remove();
								database.address = geolocation.properties.label;
								document.getElementById('answer').innerHTML = `${database.address}? OK !`;
							}
						}
					})
					.catch(error => console.log(error))
				}
			}

			/*
		  searchControl.on('results', function(data){
		    results.clearLayers();
		    for (var i = data.results.length - 1; i >= 0; i--) {
		      results.addLayer(L.marker(data.results[i].latlng));
		    }
		  });
			*/

			function buildUrl(url, parameters) {
			    let qs = "";
			    for (const key in parameters) {
			        if (parameters.hasOwnProperty(key)) {
			            const value = parameters[key];
			            qs +=
			                encodeURIComponent(key) + "=" + encodeURIComponent(value) + "&";
			        }
			    }
			    if (qs.length > 0) {
			        qs = qs.substring(0, qs.length - 1); //chop off last "&"
			        url = url + "?" + qs;
			    }

			    return url;
			}

			</script>
	</body>
</html>
